/* CSS for DrawSteelJournalEntrySheet */
/*framing content*/
.draw-steel.journal-sheet .window-content,
.draw-steel.journal-sheet .window-header,
.draw-steel.journal-sheet .journal-sidebar {
  backdrop-filter: none;
  background: var(--draw-steel-c-white);
  color: var(--draw-steel-c-light);
  /* optimize legibility to see if this fixes title uneveness on subpixel rounding*/
  -webkit-font-smoothing: antialiased;
  font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;

  .active {
    text-shadow: none;
    background: transparent;
    background-image: linear-gradient(to left, var(--draw-steel-c-faint), transparent);
  }

  h1 {
    font-family: 'Newsreader', serif;
    font-weight: bold;
    border-color: transparent;
    border-image: linear-gradient(to right, var(--draw-steel-c-faint), transparent) 1;
    border-image-slice: 1;
  }

  /*special class pages*/
  .class-spread {
    img {
      outline: 1px solid rgba(255, 255, 255, 0.5);
      outline-offset: -6px;
    }

    blockquote {
      position: absolute;
      bottom: 0;
      left: 0;
      z-index: 9;
      container-type: inline-size;
      width: 100%;
      padding: 10px;
      font-weight: bolder;
      text-shadow: black 1px 1px 2px, rgb(118, 118, 121) 0px 0px 1em, rgb(117, 117, 118) 0px 0px 0.2em;

      .pull-quote {
        font-size: clamp(0.75rem, 6cqw, 3rem)
      }

      cite {
        font-size: clamp(0.5rem, 4cqw, 2rem)
      }
    }

    .class-intro-wrapper {
      position: absolute;
      top: 4em;
      left: 0px;
      container-type: inline-size;
      width: 40%;
      max-width: 400px;
      padding: 10px;
      font-weight: bolder;
      text-shadow: black 1px 1px 2px, rgb(118, 118, 121) 0px 0px 1em, rgb(117, 117, 118) 0px 0px 0.2em;
      min-width: 200px;

      .class-intro {
        font-size: clamp(0.75rem, 6cqw, 1rem);
      }
    }
  }

  /*special treatments*/
  .journal-page-header h1,
  h1.chapter,
  h1.window-title {
    font-family: 'Modesto Condensed', serif;
    border-bottom: 0px;
    border-color: transparent;
    border-image: initial;
  }

  h1.window-title {
    font-size: var(--font-size-20);
  }

  .chapter,
  .journal-page-header {
    font-size: 1.5em;
    padding-top: 0.5em;
  }

  h2 {
    font-family: 'Newsreader', serif;
    font-weight: bold;
    border-bottom: 0px;
  }

  h3 {
    font-variant: small-caps;
  }

  h3,
  h4,
  h5 {
    font-family: 'Newsreader', serif;
    font-weight: bold;
  }


  h5 {
    --font-h5-size: 1em;

    a.content-link {
      padding: 3px 4px;
    }
  }

  h6 {
    --font-h6-size: 1em;
    font-family: 'Atkinson Hyperlegible', serif;
    font-weight: bold;
  }

  .window-title,
  button,
  .page-title {
    color: var(--color-text-primary);
  }

  button:disabled {
    opacity: 0.4;
    pointer-events: none;
  }

  a:hover {
    text-shadow: 0 0 1px var(--draw-steel-c-color-shadow);
  }

  a.button,
  button {
    background: var(--draw-steel-c-white);
  }

  a.button:hover,
  button:hover {
    background: var(--draw-steel-c-laserline);
    color: whitesmoke;
  }

  /*contents*/
  li .page-heading {}

  .toc ol li ol,
  .toc ol li ol li {
    position: relative;

    .page-title {}

    /*specificity override*/
    .heading-link,
    .page-heading {}

    /*laser line highlight specific to contents menu*/
    a:after {
      content: '';
      position: absolute;
      width: 100%;
      transform: scaleX(0);
      height: 1px;
      bottom: 0;
      left: 0;
      background-color: var(--draw-steel-c-laserline);
      transition: transform 0.25s ease-out;
      transform-origin: bottom left;
    }

    a:hover::after {
      transform: scaleX(1);
    }

    & {
      color: var(--draw-steel-dark);
    }

    &.page {
      border-top: 0px transparent;
      border-bottom: 0px transparent;
    }
  }

}

/*body content*/
.draw-steel.journal-sheet .journal-entry,
.draw-steel .journal-entry-page,
#tooltip.draw-steel section.content,
aside[role="tooltip"] section.content {
  .hanging-indent {
    /* Indents the entire block */
    padding-left: 1em;
    /* Pulls the first line back */
    text-indent: -1em;

    * {
      text-indent: initial;
    }
  }

  /*gold framed boxes with deco top and bottom*/
  aside.boxed {
    border-image-source: url(/systems/draw-steel/assets/ui/mcdm-box.svg);
    border-image-slice: 40 40 40 40;
    border-image-width: 120px;
    border-image-repeat: repeat;
    padding: 40px 40px 40px 40px;
    max-width: 650px;
    margin: 0px auto;

    /*some asides are inverted to indicate DM / technical tips. polygon clip fill to create a bevel*/
    div.inverse {
      background-color: black;
      clip-path: polygon(
        /* top edge */
        var(--corner) 0%,
        /* left top */
        calc(100% - var(--corner)) 0%,
        /* right top */
        /* right edge */
        100% var(--corner),
        /* right top */
        100% calc(100% - var(--corner)),
        /* right bottom */
        /* bottom edge*/
        calc(100% - var(--corner)) 100%,
        /* right bottom */
        var(--corner) 100%,
        /* left bottom*/
        /* left edge */
        0% calc(100% - var(--corner)),
        /* left bottom */
        0% var(--corner)
        /* left top */
        );
      --corner: 1em;
      background: var(--draw-steel-c-black);
      color: var(--draw-steel-c-white);
      padding: 1rem;
      margin: 0px 0px 8px;

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        color: var(--draw-steel-c-white);
      }
    }
  }


  .journal-header input {
    font-family: 'Draw Steel Book', serif;
    color: var(--draw-steel-dark);
  }

  /*imports*/
  .glyph {
    font-family: Draw Steel Glyphs;
  }

  .left {
    text-align: left;
  }

  .right {
    text-align: right;
  }

  .center {
    text-align: center;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    background: var(--input-background-color);

    th,
    td {
      padding: 8px;
    }

    thead {
      border: none;
    }

    tbody tr:nth-child(odd) {
      background: var(--input-background-color);
    }

    &.compact {

      th,
      td {
        padding-top: 0;
        padding-bottom: 0;
      }
    }
  }


  a {
    color: var(--draw-steel-c-laserline);
  }

  a:hover {
    text-shadow: transparent;
  }

  aside.callout {
    --b: 0px;
    --s: 0px;
    display: inline-block;
    min-height: 80px;
    position: relative;
    z-index: 0;
    padding: 20px;
    background-color: var(--draw-steel-c-faint);
    background-origin: padding-box;
    border: 2px solid orange;
    margin-left: 40px;
    width: calc(100% - 64px);
    border-radius: 6px;
    z-index: 1;

    .icon {
      width: 4em;
      height: 4em;
      margin-left: -3.5em;
      z-index: 2;
      position: absolute;
      top: calc(50% - 2em);
      filter: drop-shadow(1px 1px 0 orange) drop-shadow(-1px -1px 0 orange) drop-shadow(1px -1px 0 orange) drop-shadow(-1px 1px 0 orange);
      /*optional todo: filter PNG to dropshadow shape and round edges for jpg at 1px border color*/
    }

    p {
      padding-left: 20px;
    }
  }

  aside.malice {
    background: linear-gradient(rgba(128, 128, 128, 0.3), rgba(128, 128, 128, 0.05));
    padding: 12px;
    corner-shape: bevel;
    border-radius: 12px;

    document-embed:after {
      content: url(/systems/draw-steel/assets/ui/continue.svg);
      width: 100%;
      height: auto;
    }

    document-embed:last-of-type:after {
      content: url(/systems/draw-steel/assets/ui/continue.svg);
      width: 100%;
      height: auto;
    }
  }

  /*laser lines on captions */
  /* STANDARD HTML TABLES */

  caption {
    text-align: center;
    position: relative;
    border-bottom: 2px solid var(--draw-steel-c-laserline);
    line-height: 0.75em;
    padding-top: 0.85em;
    width: 100%;
    border-image: linear-gradient(to right, #ffffff03, #866d4b99, #ffffff03) 1;
    border-image-slice: 1;
    margin-bottom: 1em;

    p {
      background: transparent;
    }

    /*strong creates the white box behind the lettering, uses before and after to place the diamonds at the edges*/
    strong {
      background: var(--draw-steel-c-white);
      padding: 0.5em 1em;
      margin-top: -0.75em;
      position: absolute;
      transform: translate(-50%, 0%);

      &::before {
        content: "速";
        font-family: Draw Steel Glyphs;
        color: #866d4b;
        position: absolute;
        left: -0.5em;
      }

      &::after {
        content: "速";
        font-family: Draw Steel Glyphs;
        color: #866d4b;
        position: absolute;
        right: -0.5em;
      }

    }

    cite {
      position: absolute;
      top: 1.25em;
      right: 0;
    }

    cite::before {
      content: '';
      clear: both;
      margin-top: 3em;
    }


    &::empty,
    &:not(:has(p)),
    &:has(p:empty) {
      border: none;
    }

  }

  .ability-bordered {
    --ability-border: var(--ability-default-border);
    &.quick {
      --ability-border: var(--ability-quick-border);
    }

    padding-left: 30px;
    background: var(--ability-border) no-repeat top left;
    background-size: 20px;
  }

  /* Embed-specific adjustments */
  document-embed {
    &.draw-steel.ability {
      .flavor {
        border-bottom: 1px solid var(--draw-steel-c-laserline-rev);
      }

      /* More compact display of abilities */
      .metadata dl {
        grid-template-columns: auto 1fr auto 1fr;
      }
    }

    .draw-steel.kit {
      .equipment dl {
        display: grid;
        grid-template-columns: auto 1fr auto 1fr auto 1fr;
      }
    }

    /* EMBEDDED ROLL TABLES */

    figure:has(table) {
      cite {
        float: right;
      }
    }

    figcaption:has(+ table) {
      caption-side: top;
      text-align: center;
      position: relative;
      line-height: 0.75em;
      padding-top: 0.85em;
      width: 100%;
      border-image: linear-gradient(to right, #ffffff03, #866d4b99, #ffffff03) 1;
      border-image-slice: 1;
      margin-bottom: 2em;


      /*if it has the table title in a strong tag*/
      &:has(strong) {
        border-bottom: 2px solid var(--draw-steel-c-laserline);

        strong {
          background: var(--draw-steel-c-white);
          margin: -0.2em;
          position: absolute;
          transform: translate(-50%, 0%);
          font-style: normal;
        }

        strong::before {
          content: "速";
          font-family: Draw Steel Glyphs;
          color: #866d4b;


        }

        strong::after {
          content: "速";
          font-family: Draw Steel Glyphs;
          color: #866d4b;
        }

        cite {
          position: absolute;
          top: 1.75em;
          right: 0;
        }

        cite::before {
          content: '';
          clear: both;
          /*margin-top: 2em;*/
        }
      }

      p {
        padding: 0.5em;
      }
    }
  }
}


/* Navigation */
.draw-steel.journal-sheet .book-navigation {
  flex-grow: 0;
  padding: 5px 0px;
  margin: 0 10px 10px;
  border: none;
  opacity: 0.2;
  transition: opacity 0.5s ease-out;

  &:hover {
    opacity: 1;
  }

  ul {
    display: flex;
    gap: 5px;
    margin: 0;
    padding-inline: 1rem;
    list-style: none;
  }

  li {
    flex: 1 1 33%;
  }

  a {
    display: block;
    border: none;
    background: none;
    text-align: center;
    text-decoration: none;
  }

  a[rel="prev"] {
    text-align: start;

    &::before {
      content: "\f060";
      font-family: var(--font-awesome);
      font-weight: bold;
      padding-inline-end: 2px;
    }
  }

  a[rel="next"] {
    text-align: end;

    &::after {
      content: "\f061";
      font-family: var(--font-awesome);
      font-weight: bold;
      padding-inline-start: 2px;
    }
  }

  a.parent {
    text-align: center;

    &::before {
      content: "\f062";
      font-family: var(--font-awesome);
      font-weight: bold;
      padding-inline-end: 3px;
    }
  }
}


/*inline links and rolls; this may deserve it's own file if it's broader than journals*/
.draw-steel .journal-entry-content,
.draw-steel .journal-entry-pages,
.draw-steel .journal-entry-page {
  background: var(--draw-steel-c-white);

  .content-link,
  .draw-steel .inline-roll {
    background: var(--draw-steel-c-white);
    border: 1px solid var(--draw-steel-c-laserline);
    border-radius: 2px;
    color: var(--draw-steel-c-laserline);
    margin: -1px 0;
    padding: 1px 4px 0;
    white-space: nowrap;
    word-break: break-all;
  }
}

/* dark theme specific art*/
.theme-dark .draw-steel.journal-sheet:not(.theme-light),
.draw-steel.journal-sheet.theme-dark {
  .journal-sidebar {
    background-image: url('/systems/draw-steel/assets/ui/drawsteel-dark.png');
    background-size: 800px;
    background-position: bottom left;
    background-repeat: no-repeat;

    .active {
      text-shadow: none;
      background: transparent;
      background-image: linear-gradient(to left, var(--draw-steel-c-laserline-rev), transparent);

    }
  }
}

/* light theme specific art*/
.theme-light .draw-steel.journal-sheet:not(.theme-dark),
.draw-steel.journal-sheet.theme-light {
  .journal-sidebar {
    background-image: url('/systems/draw-steel/assets/ui/drawsteel-light.png');
    background-size: 1000px;
    background-position: bottom left;
    background-repeat: no-repeat;
  }
}
